<div class="container">

  <!-- Sidebar -->
  <aside class="sidebar">
    <h2 class="logo">⚖️ Law Firm</h2>
    <nav>
      <a href="#cases" onclick="showSection('cases')">Cases</a>
      <a href="#assignments" onclick="showSection('assignments')">Assignments</a>
      <a href="#advocates" onclick="showSection('advocates')">Advocates</a>
      <a href="#clients" onclick="showSection('clients')">Clients</a>
    </nav>
  </aside>

  <main class="main-content">
    <header><h1>Dashboard</h1></header>

    <!-- Sections -->
    <section id="cases" class="data-section">
      <h2>Case Details</h2>
      <table id="case-table">
        <thead>
          <tr>
            <th>Case ID</th>
            <th>Client</th>
            <th>Case Type</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="assignments" class="data-section" style="display:none;">
      <h2>Case Assignments</h2>
      <table id="assignment-table">
        <thead>
          <tr>
            <th>Assignment ID</th>
            <th>Case</th>
            <th>Advocate</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="advocates" class="data-section" style="display:none;">
      <h2>Advocates</h2>
      <table id="advocate-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Designation</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <section id="clients" class="data-section" style="display:none;">
      <h2>Clients</h2>
      <table id="client-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Client Type</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>
  </main>
</div>

<script>
  const BASE_URL = "/api/resource/";

  function showSection(sectionId) {
    document.querySelectorAll('.data-section').forEach(sec => sec.style.display = 'none');
    document.getElementById(sectionId).style.display = 'block';
  }

  async function fetchRecords(doctype, tableId, fields=[]) {
    try {
      let url = BASE_URL + doctype;
      if(fields.length) url += "?fields=" + JSON.stringify(fields);
      const res = await fetch(url);
      const data = await res.json();
      const tbody = document.getElementById(tableId).querySelector('tbody');
      tbody.innerHTML = "";
      data.data.forEach(record => {
        const row = document.createElement('tr');
        Object.values(record).forEach(val => {
          const td = document.createElement('td');
          td.textContent = val;
          row.appendChild(td);
        });
        tbody.appendChild(row);
      });
    } catch(err) {
      console.error(err);
    }
  }

  window.onload = () => {
    fetchRecords("Case Details", "case-table", ["name","client","case_type","status"]);
    fetchRecords("Case Assignment", "assignment-table", ["name","case","advocate","status"]);
    fetchRecords("Advocate", "advocate-table", ["name","email","designation"]);
    fetchRecords("Client", "client-table", ["name","client_type","email"]);
  }
</script>
