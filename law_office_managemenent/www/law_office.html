<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Law Firm Management – Demo</title>
  <!-- Icons -->
  <script src="https://unpkg.com/feather-icons"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #0f1221;
      --bg-soft: #141835;
      --card: #1a1f47;
      --text: #e7e9ff;
      --muted: #a3a9d9;
      --accent: #7c5cff;
      --accent-2: #2de2e6;
      --good: #3ddc97;
      --warn: #ffbd59;
      --bad: #ff6b6b;
      --shadow: 0 20px 40px rgba(0, 0, 0, .35);
      --radius: 16px;
    }

    * {
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
    }

    body {
      margin: 0;
      background: radial-gradient(1200px 800px at 15% 10%, rgba(124, 92, 255, .15), transparent 60%),
        radial-gradient(900px 600px at 85% 90%, rgba(45, 226, 230, .12), transparent 60%),
        var(--bg);
      color: var(--text);
      font: 15px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }

    /* Layout */
    .app {
      display: grid;
      grid-template-columns: 260px 1fr;
      min-height: 100dvh;
    }

    aside {
      position: sticky;
      top: 0;
      height: 100dvh;
      background: linear-gradient(180deg, rgba(26, 31, 71, .9), rgba(20, 24, 53, .9));
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, .06);
      padding: 22px 16px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      letter-spacing: .2px;
      margin-bottom: 18px;
      padding: 10px;
      border-radius: 12px;
      background: linear-gradient(90deg, rgba(124, 92, 255, .2), rgba(45, 226, 230, .12));
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, .06);
    }

    nav {
      display: grid;
      gap: 6px;
      margin-top: 8px;
    }

    .nav-btn {
      display: flex;
      align-items: center;
      gap: 12px;
      width: 100%;
      padding: 12px 14px;
      border: 0;
      border-radius: 12px;
      background: transparent;
      color: var(--text);
      text-align: left;
      cursor: pointer;
      transition: transform .12s ease, background .2s ease, box-shadow .2s ease;
    }
    .nav-btn a{
      color: var(--text);
      text-decoration:none;
      align-items: center;

    }
    .nav-btn:hover {
      transform: translateY(-1px);
      background: rgba(255, 255, 255, .04);
      transition: transform .12s ease, background .2s ease, box-shadow .2s ease;
    }

    .nav-btn.active {
      background: linear-gradient(90deg, rgba(124, 92, 255, .25), rgba(45, 226, 230, .18));
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, .06);
    }

    .nav-section {
      margin-top: 18px;
      color: var(--muted);
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: .12em;
      padding: 0 6px;
    }

    .main {
      padding: 22px clamp(16px, 4vw, 36px);
      display: grid;
      gap: 18px;
    }

    /* Topbar */
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }

    .search {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255, 255, 255, .04);
      border: 1px solid rgba(255, 255, 255, .06);
      transition: background .2s ease, box-shadow .2s ease;
    }

    .search:focus-within {
      background: rgba(255, 255, 255, .07);
      box-shadow: 0 0 0 3px rgba(124, 92, 255, .18);
    }

    .search input {
      all: unset;
      width: 100%;
      color: var(--text);
    }

    .user {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: var(--shadow);
    }

    /* Panels */
    .cards {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 16px;
    }

    .card {
      background: linear-gradient(180deg, rgba(26, 31, 71, .85), rgba(20, 24, 53, .9));
      border: 1px solid rgba(255, 255, 255, .07);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: var(--shadow);
      animation: floatIn .5s ease both;
    }

    .card h3 {
      margin: 0 0 6px;
      font-size: 14px;
      color: var(--muted);
      font-weight: 600;
    }

    .stat {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: .2px;
    }

    .trend {
      font-size: 12px;
      color: var(--muted);
    }

    .col-3 {
      grid-column: span 3;
    }

    .col-4 {
      grid-column: span 4;
    }

    .col-6 {
      grid-column: span 6;
    }

    .col-8 {
      grid-column: span 8;
    }

    .col-12 {
      grid-column: 1 / -1;
    }

    @media (max-width: 1100px) {
      .app {
        grid-template-columns: 88px 1fr;
      }

      .label {
        display: none;
      }
    }

    @media (max-width: 860px) {
      .cards {
        grid-template-columns: repeat(6, 1fr);
      }

      .col-8 {
        grid-column: 1 / -1;
      }

      .col-6 {
        grid-column: 1 / -1;
      }

      aside {
        display: none;
      }
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
    }

    th,
    td {
      padding: 12px 10px;
      border-bottom: 1px solid rgba(255, 255, 255, .06);
    }

    th {
      text-align: left;
      color: var(--muted);
      font-weight: 600;
      font-size: 12px;
      letter-spacing: .08em;
      text-transform: uppercase;
    }

    tr {
      transition: background .2s ease;
    }

    tbody tr:hover {
      background: rgba(255, 255, 255, .03);
    }

    .badge {
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    .badge.good {
      background: rgba(61, 220, 151, .15);
      color: var(--good);
    }

    .badge.warn {
      background: rgba(255, 189, 89, .15);
      color: var(--warn);
    }

    .badge.bad {
      background: rgba(255, 107, 107, .15);
      color: var(--bad);
    }

    /* Forms */
    .grid {
      display: grid;
      gap: 12px;
    }

    .grid.cols-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    .grid.cols-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    label {
      font-size: 12px;
      color: var(--muted);
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, .08);
      background: rgba(255, 255, 255, .04);
      color: var(--text);
      transition: border-color .2s ease, transform .1s ease;
    }

    input:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(124, 92, 255, .18);
      transform: translateY(-1px);
    }

    .btn {
      padding: 10px 14px;
      border: 0;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color: #061018;
      transition: transform .12s ease, filter .2s ease, box-shadow .2s ease;
      box-shadow: var(--shadow);
    }

    .btn:hover {
      transform: translateY(-1px) scale(1.01);
      filter: brightness(1.05);
    }

    .btn.secondary {
      background: rgba(255, 255, 255, .08);
      color: var(--text);
      font-weight: 600;
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .tab-btn {
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, .1);
      background: rgba(255, 255, 255, .04);
      color: var(--text);
      cursor: pointer;
    }

    .tab-btn.active {
      background: linear-gradient(90deg, rgba(124, 92, 255, .25), rgba(45, 226, 230, .2));
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .55);
      display: none;
      place-items: center;
      z-index: 99;
      animation: fadeIn .25s ease both;
    }

    .modal {
      width: min(720px, 92vw);
      background: var(--bg-soft);
      border: 1px solid rgba(255, 255, 255, .08);
      border-radius: 18px;
      padding: 16px;
      box-shadow: var(--shadow);
      transform-origin: top center;
      animation: popIn .25s ease both;
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    /* Notifications */
    .toasts {
      position: fixed;
      right: 18px;
      bottom: 18px;
      display: grid;
      gap: 8px;
      z-index: 100;
    }

    .toast {
      background: var(--card);
      border: 1px solid rgba(255, 255, 255, .08);
      padding: 12px 14px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      animation: slideUp .35s ease both;
    }

    /* Animations */
    @keyframes floatIn {
      from {
        opacity: 0;
        transform: translateY(10px) scale(.98);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes popIn {
      from {
        opacity: 0;
        transform: scale(.96);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulseGlow {
      0% {
        box-shadow: 0 0 0 0 rgba(124, 92, 255, .4);
      }

      70% {
        box-shadow: 0 0 0 12px rgba(124, 92, 255, 0);
      }

      100% {
        box-shadow: 0 0 0 0 rgba(124, 92, 255, 0);
      }
    }

    .view {
      display: none;
      animation: fadeIn .25s ease both;
    }

    .view.active {
      display: grid;
      gap: 16px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, .08);
      background: rgba(255, 255, 255, .04);
      font-size: 12px;
      color: var(--muted);
    }

    /* Timeline */
    .timeline {
      position: relative;
      padding-left: 22px;
    }

    .timeline::before {
      content: "";
      position: absolute;
      left: 8px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(var(--accent), transparent);
      border-radius: 999px;
    }

    .tl-item {
      position: relative;
      margin-bottom: 14px;
      padding-left: 8px;
    }

    .tl-item::before {
      content: "";
      position: absolute;
      left: -10px;
      top: 6px;
      width: 10px;
      height: 10px;
      background: var(--accent);
      border-radius: 50%;
      animation: pulseGlow 2.2s ease infinite;
    }
  </style>
</head>

<body>
  <div class="app">
    <aside>
      <div class="logo"><i data-feather="briefcase"></i><span>Law Associates</span></div>
      <div class="nav-section">Main</div>
      <nav>
  <button class="nav-btn active" data-view="advocate">
    <i data-feather="user"></i>
    <span class="label"><a href="law/Advocate">Advocate</a></span>
  </button>

  <button class="nav-btn" data-view="client">
    <i data-feather="users"></i>
    <span class="label"><a href="law/Client">Client</a></span>
  </button>

  <button class="nav-btn" data-view="case">
    <i data-feather="folder"></i>
    <span class="label"><a href="law/Case">Case</a></span>
  </button>

  <button class="nav-btn" data-view="case-details">
    <i data-feather="file-text"></i>
    <span class="label"><a href="law/Case Details">Case Details</a></span>
  </button>

  <button class="nav-btn" data-view="case-assignment">
    <i data-feather="users"></i>
    <span class="label"><a href="law/Case Assignment">Case Assignment</a></span>
  </button>

  <button class="nav-btn" data-view="bail">
    <i data-feather="file"></i>
    <span class="label"><a href="law/Bail">Bail</a></span>
  </button>

  <button class="nav-btn" data-view="client-consultation">
    <i data-feather="message-square"></i>
    <span class="label"><a href="law/Client Consultation">Conultations</a></span>
  </button>
</nav>



      <div class="nav-section">Utilities</div>
      <nav>
        <button class="nav-btn" id="btn-open-modal"><i data-feather="plus-circle"></i><span class="label">New
            Case</span></button>
        <button class="nav-btn" id="btn-theme"><i data-feather="moon"></i><span class="label">Toggle
            Glow</span></button>
      </nav>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="search">
          <i data-feather="search"></i>
          <input id="searchAll" placeholder="Search clients, cases, notes…" />
        </div>
        <div class="user">
          <div class="chip"><i data-feather="shield"></i> Junior Advocate</div>
          <div class="avatar" title="You"></div>
        </div>
      </div>

      <!-- Stats Row -->
      <section class="cards">
        <div class="card col-3">
          <h3>Total Cases</h3>
          <div class="stat" id="stat-total">48</div>
          <div class="trend">+3 this week</div>
        </div>
        <div class="card col-3">
          <h3>Open</h3>
          <div class="stat" id="stat-open">31</div>
          <div class="trend"><span class="badge warn">In Progress</span></div>
        </div>
        <div class="card col-3">
          <h3>Won</h3>
          <div class="stat" id="stat-won">12</div>
          <div class="trend"><span class="badge good">Up 8%</span></div>
        </div>
        <div class="card col-3">
          <h3>Alerts</h3>
          <div class="stat" id="stat-alerts">2</div>
          <div class="trend"><span class="badge bad">Hearing Today</span></div>
        </div>

        <!-- Chart Card -->
        <div class="card col-8">
          <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;">
            <h3>Monthly Cases</h3>
            <div class="chip"><i data-feather="activity"></i> Live</div>
          </div>
          <canvas id="casesChart" height="140"></canvas>
        </div>

        <div class="card col-4">
          <h3>Quick Actions</h3>
          <div class="grid">
            <button class="btn" id="quickAdd"><i data-feather="plus"></i> <span style="vertical-align:middle">Add New
                Case</span></button>
            <button class="btn secondary" id="exportCSV"><i data-feather="download"></i> Export CSV</button>
            <button class="btn secondary" id="simulateEvent"><i data-feather="bell"></i> Simulate Alert</button>
          </div>
        </div>
      </section>

      <!-- Views -->
      <section id="view-profile" class="view active">
        <div class="card col-12">
          <h2 style="margin:0 0 12px">Profile</h2>
          <div class="grid cols-3">
            <div>
              <label>Full Name</label>
              <input type="text" id="prof-name" value="A. K. Meeran" />
            </div>
            <div>
              <label>Email</label>
              <input type="text" id="prof-email" value="meeran@example.com" />
            </div>
            <div>
              <label>Phone</label>
              <input type="text" id="prof-phone" value="+91 90000 00000" />
            </div>
            <div>
              <label>Specialization</label>
              <select id="prof-spec">
                <option>Civil</option>
                <option selected>Criminal</option>
                <option>Family</option>
                <option>Labour</option>
              </select>
            </div>
            <div>
              <label>Bar ID</label>
              <input type="text" value="TN-2021-LEX-0901" />
            </div>
            <div>
              <label>Location</label>
              <input type="text" value="Chennai" />
            </div>
          </div>
          <div style="margin-top:12px; display:flex; gap:10px;">
            <button class="btn" id="saveProfile"><i data-feather="save"></i> Save Changes</button>
            <button class="btn secondary" id="resetProfile"><i data-feather="rotate-ccw"></i> Reset</button>
          </div>
        </div>
      </section>

      <section id="view-cases" class="view">
        <div class="card col-12">
          <div style="display:flex; align-items:end; justify-content:space-between; gap:12px; flex-wrap: wrap;">
            <div>
              <h2 style="margin:0">Cases</h2>
              <div style="color:var(--muted); font-size:13px;">Manage all ongoing and closed matters</div>
            </div>
            <div style="display:flex; gap:8px;">
              <select id="filterStatus">
                <option value="all">All Status</option>
                <option value="Open">Open</option>
                <option value="In Progress">In Progress</option>
                <option value="Closed">Closed</option>
              </select>
              <button class="btn" id="btnAddCase"><i data-feather="plus"></i> Add Case</button>
            </div>
          </div>

          <div style="margin-top:8px; overflow:auto;">
            <table id="casesTable">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Case ID</th>
                  <th>Client</th>
                  <th>Type</th>
                  <th>Hearing</th>
                  <th>Status</th>
                  <th>Assigned To</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <section id="view-case-details" class="view">
        <div class="card col-12">
          <div style="display:flex; align-items:center; justify-content:space-between;">
            <div>
              <h2 style="margin:0">Case Details</h2>
              <div class="chip"><i data-feather="hash"></i> CF-2025-00042</div>
            </div>
            <div class="chip"><i data-feather="calendar"></i> Next: 12 Sep 2025</div>
          </div>

          <div class="tabs">
            <button class="tab-btn active" data-tab="summary">Summary</button>
            <button class="tab-btn" data-tab="hearings">Hearings</button>
            <button class="tab-btn" data-tab="documents">Documents</button>
          </div>

          <div id="tab-summary">
            <div class="grid cols-2">
              <div>
                <h3>Overview</h3>
                <p style="color:var(--muted)">Client alleges breach of contract. Mediation attempted; proceeding to
                  trial. Opposing counsel requested additional disclosures.</p>
                <div class="timeline">
                  <div class="tl-item"><strong>2025-08-10</strong> – Evidence bundle uploaded</div>
                  <div class="tl-item"><strong>2025-08-02</strong> – Mediation session held</div>
                  <div class="tl-item"><strong>2025-07-15</strong> – Case filed</div>
                </div>
              </div>
              <div>
                <h3>People</h3>
                <div class="grid">
                  <div class="chip"><i data-feather="user"></i> Client: Priya K</div>
                  <div class="chip"><i data-feather="user"></i> Opponent: Orion Pvt Ltd</div>
                  <div class="chip"><i data-feather="users"></i> Team: You, S. Rao</div>
                </div>
              </div>
            </div>
          </div>

          <div id="tab-hearings" style="display:none;">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Stage</th>
                  <th>Notes</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>2025-09-12</td>
                  <td>Trial</td>
                  <td>Ensure witness-2 available</td>
                </tr>
                <tr>
                  <td>2025-08-22</td>
                  <td>Arguments</td>
                  <td>Submitted written arguments</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div id="tab-documents" style="display:none;">
            <div class="grid">
              <div class="chip"><i data-feather="paperclip"></i> Petition.pdf</div>
              <div class="chip"><i data-feather="paperclip"></i> Affidavit.docx</div>
              <div class="chip"><i data-feather="paperclip"></i> Evidence.zip</div>
            </div>
          </div>
        </div>
      </section>

      <section id="view-case-assignment" class="view">
        <div class="card col-12">
          <h2 style="margin:0 0 8px">Case Assignment</h2>
          <p style="margin:0 0 8px; color:var(--muted)">Assign senior and junior advocates to a case. Fields glow on
            validation.</p>
          <div class="grid cols-3">
            <div>
              <label>Case</label>
              <select id="asgn-case"></select>
            </div>
            <div>
              <label>Senior Advocate</label>
              <select id="asgn-senior">
                <option value="">Select</option>
                <option>R. Iyer</option>
                <option>S. Rao</option>
                <option>A. Khan</option>
              </select>
            </div>
            <div>
              <label>Junior Advocate</label>
              <select id="asgn-junior">
                <option value="">Select</option>
                <option>Meera J</option>
                <option>Arun K</option>
                <option>Divya P</option>
              </select>
            </div>
            <div class="col-12">
              <label>Notes</label>
              <textarea id="asgn-notes" rows="3" placeholder="Add special instructions…"></textarea>
            </div>
          </div>
          <div style="margin-top:12px; display:flex; gap:10px;">
            <button class="btn" id="assignBtn"><i data-feather="check"></i> Assign</button>
            <button class="btn secondary" id="clearAssign"><i data-feather="x"></i> Clear</button>
          </div>
        </div>
      </section>

      <div class="toasts" id="toasts"></div>
    </main>
  </div>

  <!-- Modal: New Case -->
  <div class="modal-backdrop" id="modalNewCase">
    <div class="modal">
      <div class="modal-header">
        <h3 style="margin:0">Create New Case</h3>
        <button class="btn secondary" id="modalClose"><i data-feather="x"></i> Close</button>
      </div>
      <div class="grid cols-2" style="margin-top:10px;">
        <div>
          <label>Client Name</label>
          <input type="text" id="nc-client" placeholder="e.g., Priya K" />
        </div>
        <div>
          <label>Case Type</label>
          <select id="nc-type">
            <option>Civil</option>
            <option>Criminal</option>
            <option>Family</option>
            <option>Labour</option>
            <option>Consumer Complaints</option>
          </select>
        </div>
        <div>
          <label>Next Hearing</label>
          <input type="date" id="nc-date" />
        </div>
        <div>
          <label>Status</label>
          <select id="nc-status">
            <option>Open</option>
            <option>In Progress</option>
            <option>Closed</option>
          </select>
        </div>
      </div>
      <div style="display:flex; gap:10px; margin-top:12px;">
        <button class="btn" id="nc-create"><i data-feather="plus"></i> Create</button>
        <button class="btn secondary" id="nc-reset"><i data-feather="rotate-ccw"></i> Reset</button>
      </div>
    </div>
  </div>

  <script>
    feather.replace();

    // ---------- DATA (mock) ----------
    const store = {
      profile: { name: 'A. K. Meeran', email: 'meeran@example.com', phone: '+91 90000 00000', spec: 'Criminal' },
      cases: [
        { id: 'CF-2025-00042', client: 'Priya K', type: 'Civil', hearing: '2025-09-12', status: 'In Progress', assigned: 'You' },
        { id: 'CR-2025-00011', client: 'Rahul S', type: 'Criminal', hearing: '2025-09-01', status: 'Open', assigned: 'S. Rao' },
        { id: 'FA-2025-00007', client: 'Asha R', type: 'Family', hearing: '2025-08-30', status: 'Open', assigned: 'You' },
        { id: 'LB-2025-00020', client: 'Nexus Ltd', type: 'Labour', hearing: '2025-10-05', status: 'Closed', assigned: 'R. Iyer' },
      ],
      chart: {
        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
        data: [6, 8, 7, 10, 9, 12, 11, 13, 9, 8, 7, 6]
      }
    };

    // Persist to localStorage for demo "real-time" feel
    if (!localStorage.getItem('lexflow-data')) {
      localStorage.setItem('lexflow-data', JSON.stringify(store));
    }
    const load = () => JSON.parse(localStorage.getItem('lexflow-data'));
    const save = (data) => localStorage.setItem('lexflow-data', JSON.stringify(data));

    // ---------- NAVIGATION ----------
    const navButtons = document.querySelectorAll('.nav-btn[data-view]');
    const views = {
      profile: document.getElementById('view-profile'),
      cases: document.getElementById('view-cases'),
      'case-details': document.getElementById('view-case-details'),
      'case-assignment': document.getElementById('view-case-assignment')
    };

    navButtons.forEach(btn => btn.addEventListener('click', () => {
      navButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const id = btn.dataset.view;
      Object.values(views).forEach(v => v.classList.remove('active'));
      views[id].classList.add('active');
    }));

    // ---------- TOASTS ----------
    const toasts = document.getElementById('toasts');
    function toast(msg) {
      const el = document.createElement('div');
      el.className = 'toast';
      el.innerHTML = msg;
      toasts.appendChild(el);
      setTimeout(() => el.remove(), 3200);
    }

    // ---------- STATS + CHART ----------
    const ctx = document.getElementById('casesChart');
    const chartState = load().chart;
    const casesChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: chartState.labels,
        datasets: [{
          label: 'Cases',
          data: chartState.data,
          tension: .35,
          fill: true,
          borderWidth: 2,
          pointRadius: 3
        }]
      },
      options: {
        plugins: { legend: { labels: { color: '#e7e9ff' } } },
        scales: {
          x: { ticks: { color: '#a3a9d9' }, grid: { color: 'rgba(255,255,255,.06)' } },
          y: { ticks: { color: '#a3a9d9' }, grid: { color: 'rgba(255,255,255,.06)' } }
        }
      }
    });

    // "Realtime" simulation: update the last data point every 6s
    setInterval(() => {
      const data = load();
      const lastIdx = data.chart.data.length - 1;
      const delta = (Math.random() * 2 - 1) * 2; // -2..2
      data.chart.data[lastIdx] = Math.max(0, Math.round((data.chart.data[lastIdx] + delta)));
      save(data);
      casesChart.data.datasets[0].data = data.chart.data;
      casesChart.update();
      document.getElementById('stat-total').textContent = data.chart.data.reduce((a, b) => a + b, 0);
      toast('<strong>Live:</strong> Monthly cases updated');
    }, 6000);

    // ---------- PROFILE ----------
    const profName = document.getElementById('prof-name');
    const profEmail = document.getElementById('prof-email');
    const profPhone = document.getElementById('prof-phone');
    const profSpec = document.getElementById('prof-spec');

    document.getElementById('saveProfile').addEventListener('click', () => {
      const data = load();
      data.profile = { name: profName.value, email: profEmail.value, phone: profPhone.value, spec: profSpec.value };
      save(data);
      toast('<strong>Profile saved.</strong>');
    });
    document.getElementById('resetProfile').addEventListener('click', () => {
      const data = load();
      profName.value = data.profile.name;
      profEmail.value = data.profile.email;
      profPhone.value = data.profile.phone;
      profSpec.value = data.profile.spec;
      toast('<strong>Profile reset.</strong>');
    });

    // ---------- CASES TABLE ----------
    const tableBody = document.querySelector('#casesTable tbody');
    const statusFilter = document.getElementById('filterStatus');

    function renderCases() {
      const data = load();
      const status = statusFilter.value;
      tableBody.innerHTML = '';
      data.cases
        .filter(c => status === 'all' || c.status === status)
        .forEach((c, i) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${i + 1}</td>
            <td>${c.id}</td>
            <td>${c.client}</td>
            <td>${c.type}</td>
            <td>${c.hearing}</td>
            <td>${badge(c.status)}</td>
            <td>${c.assigned}</td>
          `;
          tableBody.appendChild(tr);
        });
      // Update assignment dropdown list
      const asgCase = document.getElementById('asgn-case');
      asgCase.innerHTML = data.cases.map(c => `<option>${c.id} – ${c.client}</option>`).join('');
      // Stats
      document.getElementById('stat-open').textContent = data.cases.filter(c => c.status !== 'Closed').length;
      document.getElementById('stat-won').textContent = Math.floor(data.cases.length / 4) + 8; // playful demo
      document.getElementById('stat-alerts').textContent = data.cases.filter(c => daysUntil(c.hearing) <= 1).length;
    }

    function badge(status) {
      const cls = status === 'Closed' ? 'good' : (status === 'In Progress' ? 'warn' : 'bad');
      return `<span class="badge ${cls}">${status}</span>`
    }
    function daysUntil(dateStr) {
      const delta = (new Date(dateStr) - new Date()) / 86400000;
      return Math.ceil(delta);
    }

    statusFilter.addEventListener('change', renderCases);

    // ---------- NEW CASE MODAL ----------
    const modal = document.getElementById('modalNewCase');
    const openModalBtns = [document.getElementById('btn-open-modal'), document.getElementById('btnAddCase'), document.getElementById('quickAdd')];
    openModalBtns.forEach(b => b && b.addEventListener('click', () => modal.style.display = 'grid'));
    document.getElementById('modalClose').addEventListener('click', () => modal.style.display = 'none');
    document.getElementById('nc-reset').addEventListener('click', () => {
      ['nc-client', 'nc-type', 'nc-date', 'nc-status'].forEach(id => {
        const el = document.getElementById(id);
        if (el.tagName === 'SELECT') el.selectedIndex = 0; else el.value = '';
      });
    });

    document.getElementById('nc-create').addEventListener('click', () => {
      const client = document.getElementById('nc-client').value.trim();
      const type = document.getElementById('nc-type').value;
      const date = document.getElementById('nc-date').value;
      const status = document.getElementById('nc-status').value;

      if (!client || !date) {
        toast('<strong>Missing:</strong> client and date are required');
        return;
      }
      const data = load();
      const id = `${type.substring(0, 2).toUpperCase()}-${new Date().getFullYear()}-${String(Math.floor(Math.random() * 99999)).padStart(5, '0')}`;
      data.cases.unshift({ id, client, type, hearing: date, status, assigned: 'You' });
      save(data);
      renderCases();
      modal.style.display = 'none';
      toast(`<strong>Case created:</strong> ${id}`);
    });

    // ---------- EXPORT CSV ----------
    document.getElementById('exportCSV').addEventListener('click', () => {
      const rows = [['Case ID', 'Client', 'Type', 'Hearing', 'Status', 'Assigned To']];
      load().cases.forEach(c => rows.push([c.id, c.client, c.type, c.hearing, c.status, c.assigned]));
      const csv = rows.map(r => r.map(v => '"' + String(v).replaceAll('"', '\"') + '"').join(',')).join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'cases.csv';
      a.click();
      URL.revokeObjectURL(a.href);
      toast('<strong>Exported CSV.</strong>');
    });

    // ---------- SIMULATE ALERT ----------
    document.getElementById('simulateEvent').addEventListener('click', () => {
      toast('<strong>Reminder:</strong> Hearing for CR-2025-00011 tomorrow 10:30 AM');
    });

    // ---------- ASSIGNMENT ----------
    const assignBtn = document.getElementById('assignBtn');
    const clearAssign = document.getElementById('clearAssign');
    function glow(el) { el.style.animation = 'pulseGlow 1.6s ease 1'; setTimeout(() => el.style.animation = '', 1600); }
    assignBtn.addEventListener('click', () => {
      const c = document.getElementById('asgn-case');
      const s = document.getElementById('asgn-senior');
      const j = document.getElementById('asgn-junior');
      const notes = document.getElementById('asgn-notes');
      if (!c.value || !s.value || !j.value) {
        [c, s, j].forEach(glow);
        toast('<strong>Fill all fields</strong> to assign.');
        return;
      }
      const data = load();
      const id = c.value.split(' – ')[0];
      const match = data.cases.find(x => x.id === id);
      if (match) { match.assigned = `${s.value} + ${j.value}`; save(data); renderCases(); }
      notes.value = '';
      [c, s, j].forEach(glow);
      toast(`<strong>Assigned:</strong> ${id} → ${s.value} & ${j.value}`);
    });
    clearAssign.addEventListener('click', () => {
      ['asgn-notes'].forEach(id => document.getElementById(id).value = '');
      ['asgn-senior', 'asgn-junior'].forEach(id => document.getElementById(id).selectedIndex = 0);
    });

    // ---------- TABS (Case Details) ----------
    const tabButtons = document.querySelectorAll('.tab-btn');
    tabButtons.forEach(b => b.addEventListener('click', () => {
      tabButtons.forEach(x => x.classList.remove('active'));
      b.classList.add('active');
      ['summary', 'hearings', 'documents'].forEach(id => {
        document.getElementById(`tab-${id}`).style.display = (b.dataset.tab === id) ? 'block' : 'none';
      })
    }));

    // ---------- SEARCH (global) ----------
    const searchAll = document.getElementById('searchAll');
    searchAll.addEventListener('input', (e) => {
      const q = e.target.value.toLowerCase();
      const rows = tableBody.querySelectorAll('tr');
      rows.forEach(row => {
        row.style.display = row.textContent.toLowerCase().includes(q) ? '' : 'none';
      })
    });

    // ---------- THEME TOGGLE (fun) ----------
    document.getElementById('btn-theme').addEventListener('click', () => {
      document.documentElement.style.setProperty('--accent', '#ff7cf8');
      document.documentElement.style.setProperty('--accent-2', '#ffd166');
      toast('<strong>Theme glow toggled.</strong>');
    });

    // Initial render
    renderCases();
  </script>
</body>

</html>